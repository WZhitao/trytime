# -*- coding: utf-8 -*-
"""LandslideDatingApp.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/15-VCNR3CJ2QysPaaUK8s-uQatJdbmhZ_
"""

import ee
import geemap.foliumap as geemap
import ipywidgets as widgets
from IPython.display import display
import os
import ee
import geemap.foliumap as geemap
import streamlit as st
from shapely.geometry import Polygon
# 创建地图
Map = geemap.Map()
Map.add_basemap('HYBRID')  # 添加卫星混合底图
Map.setCenter(-98.5795, 39.8283, 4)  # 设置美国本土中心位置

# 创建按钮
button = widgets.Button(
    description='添加县级行政区划',
    button_style='success',  # 绿色按钮
    tooltip='点击添加美国县级行政区划图层'
)

# 按钮点击事件处理函数
def on_button_clicked(b):
    # 加载县级行政区划数据
    counties = ee.FeatureCollection('TIGER/2018/Counties')

    # 设置可视化参数
    vis_params = {
        'color': 'FF5500',    # 边界颜色 (橙色)
        'width': 1,           # 边界宽度
        'fillColor': '00000000' # 填充颜色 (透明)
    }

    # 添加图层到地图
    Map.addLayer(counties.style(**vis_params), {}, '美国县级行政区划')

    # 添加图例
    Map.add_legend(
        title='行政区划边界',
        colors=['#FF5500'],
        labels=['县界']
    )

    # 更新按钮状态
    button.description = '已添加'
    button.disabled = True
    button.button_style = ''  # 移除高亮样式

# 绑定按钮点击事件
button.on_click(on_button_clicked)

# 创建控制面板
control_panel = widgets.VBox([
    widgets.HTML('<h3>美国行政区划数据</h3>'),
    button,
    widgets.HTML('<p style="color:#888">TIGER/2018/Counties 数据集</p>')
])

# 显示地图和控制面板
display(control_panel)
# Map






# 最后，在 Streamlit 页面里渲染地图：
st.header("我的 Earth Engine 地图")
Map.to_streamlit(height=600)
